{% extends 'base.html' %}
{% load humanize %}

{% block title %}
	Actualizar Precios - Solo Admins
{% endblock %}

{% block script_head %}
<style type="text/css">
	.precio-nuevo{
		color: #16a200;
		font-weight: bold;
	}
    .diferencia{
        color: #008eff;
    }
    .danger{
        color: #cd0300;
        font-weight: bold;
    }
</style>
{% endblock %}

{% block posicion_pagina %}
<ol class="breadcrumb">
	<li><a href="{% url 'home'%}">Inicio</a></li>
	<li><a class="active" href="{% url 'actualizar_precio'%}">Actualizar Precios</a></li>
</ol>
{% endblock %}


{% block content %}
<div class="container-fluid">
    <div class="row">
		<form class="form-horizontal" id="form-modificar-precio" method="get">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h3 class="item-heading bg-grey">Actualizar Precios</h3>
				<hr>
				<div class="form-group">
                    <label class="col-lg-2 col-md-2 col-sm-2 col-xs-4 control-label">Archivo</label>
                    <div class="col-lg-5 col-md-5 col-sm-5 col-xs-6">
                        <select class="form-control" name="file" id="file">
                            <option>---</option>
                            {% for file in listado_archivos %}
                                <option {% if file.pk == file_selected %} selected="selected" {% endif %} value="{{ file.pk }}">{{ file }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-default"  {% if file_selected %} disabled="disabled" {% endif %}>Cargar</button>
                    </div>
                </div>
			</div>
			<hr>
		</form>
        {% if listado_pendiente_actualizar %}
        <div class="col-lg-12">
            <h3 class="text-center item-heading">SALDO INVENTARIO CON CAMBIOS EN PRECIOS</h3>
            <div class="table-responive">
                <table id="tabla_pedido" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Producto</th>
                            <th>Referencia</th>
                            <th>Cantidad</th>
                            <th>Costo Total</th>
                            <th>Precio Venta Unitario</th>
                            <th class="precio-nuevo">Nuevo Precio</th>
                            <th class="diferencia">Diferencia</th>
                            <th>Precio Venta</th>
                            <th class="precio-nuevo">Precio Venta Nuevo</th>
                            <th>Precio Oferta</th>
                            <th class="precio-nuevo">Precio Oferta Nuevo</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for sa in listado_pendiente_actualizar %}
                        <tr {% if sa.isDanger %} class="danger" {% endif %} >
                            <td>{{ sa.saldoInventario.producto }}</td>
                            <td>{{ sa.saldoInventario.referenciaProveedor }}</td>
                            <td>{{ sa.saldoInventario.cantidad  }}</td>
                            <td>{{ sa.saldoInventario.costoTotal|stringformat:"d"|intcomma }}</td>
                            <td>{{ sa.saldoInventario.precioCompraUnitario|stringformat:"d"|intcomma }}</td>
                            <td class="precio-nuevo">{{ sa.valor|stringformat:"d"|intcomma }}</td>
                            <td class="diferencia">{{ sa.diferencia|stringformat:"d"|intcomma }}</td>
                            <td>{{ sa.saldoInventario.precioVentaUnitario|stringformat:"d"|intcomma }}</td>
                            <td class="precio-nuevo">{{ sa.precioVentaNuevo|stringformat:"d"|intcomma }}</td>
                            <td>{{ sa.saldoInventario.precioOferta|stringformat:"d"|intcomma }}</td>
                            <td class="precio-nuevo">{{ sa.precioOfertaNuevo|stringformat:"d"|intcomma }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="file" value="{{ file_selected }}">
                <button type="button" class="btn btn-success " data-toggle="modal" data-target="#modalSubmit" style="float: right;">Actualizar Precios</button>
                <div id="modalSubmit" class="modal fade" tabindex="-1" role="dialog">
					  <div class="modal-dialog" role="document">
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					        	<span aria-hidden="true">&times;</span>
					        </button>
					        <h4 class="modal-title item-heading">Alerta</h4>
					      </div>
					      <div class="modal-body">
					        <p class="item-text">Â¿Esta seguro de continuar?</p>
					      </div>
					      <div class="modal-footer">
					        <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
					        <button type="submit" class="btn btn-primary">Si</button>
					      </div>
					    </div><!-- /.modal-content -->
					  </div><!-- /.modal-dialog -->
					</div><!-- /.modal -->
            </form>
        </div>
        {% endif %}
        {% if listado_pendiente_crear %}
        <div class="col-lg-12">
            <h3 class="text-center item-heading">SALDO INVENTARIOS NO ENCONTRADOS</h3>
            <div class="table-responive">
                <table id="tabla_pedido" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Producto</th>
                            <th>Referencia</th>
                            <th>Precio</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for sa in listado_pendiente_crear %}
                        <tr>
                            <td>{{ sa.producto}}</td>
                            <td>{{ sa.referencia }}</td>
                            <td>{{ sa.valor|stringformat:"d"|intcomma }}</td>
                            <td></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
	</div>
</div>
{% endblock %}
